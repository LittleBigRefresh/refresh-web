@if (level) {
  <app-fancy-header [title]="level.title | default: 'Unnamed Level'" [description]="level.description | default: 'This level doesn\'t have a description.'">
    <app-level-avatar [level]="level" [size]="(layout.isMobile | async) ? 90 : 176" avatar></app-level-avatar>
    <ng-container titleSubtext>
      @if (level.isReUpload) {
        <div class="flex flex-row flex-wrap gap-x-1 text-nowrap text-md">
          <span>originally by <app-original-publisher-router-link [level]="this.level"></app-original-publisher-router-link>, </span>
          <span>uploaded by <app-user-link [user]="level.publisher"></app-user-link></span>
        </div>
      }
      @else {
        <p class="text-nowrap">
          by <app-user-link [user]="level.publisher"></app-user-link>
        </p>
      }
    </ng-container>

    <!-- Various non-label properties, shown as labels -->
    <div belowStatistics class="flex flex-row flex-wrap my-1 gap-x-2 gap-y-1">
      <app-tooltip [text]="'This level was published in ' + (level.gameVersion | game: false)">
        <app-larger-label [primary]="true">{{level.gameVersion | game: isMobile}}</app-larger-label>
      </app-tooltip>

      @if (level.isModded) {
        <app-tooltip text="This level contains modded assets">
          <app-larger-label [primary]="true">Modded</app-larger-label>
        </app-tooltip>
      }
    </div>

    @if (!isMobile) {
      <div belowTitleRight class="flex flex-col flex-grow text-gentle italic sm:text-sm md:text-sm text-md mr-1">
        <div class="flex flex-row gap-x-1 text-nowrap justify-end">
          <p>published</p><app-date [date]="level.publishDate"></app-date>
        </div>
        
        @if(level.updateDate != level.publishDate) {
          <div class="flex flex-row gap-x-1 text-nowrap justify-end">
            <p>updated</p><app-date [date]="level.updateDate"></app-date>
          </div>
        }
      </div>
    }
    @else {
      <div belowTitle class="text-gentle italic">
        published <app-date [date]="level.publishDate"></app-date>
        
        @if(level.updateDate != level.publishDate) {, 
          updated <app-date [date]="level.updateDate"></app-date>
        }
      </div>
    }

    <app-level-statistics [level]="level" class="mb-1.5 block" statistics></app-level-statistics>
    @if(relations && !isMobile) {
      <app-fancy-header-level-buttons [level]="level" [ownUser]="ownUser!" [relations]="relations" buttonArea></app-fancy-header-level-buttons>
    }
    @else if(relations && isMobile) {
      <app-fancy-header-level-buttons [level]="level" [ownUser]="ownUser!" [relations]="relations" buttonAreaMobile></app-fancy-header-level-buttons>
    }
  </app-fancy-header>

  <app-two-pane-layout>
      <app-container class="w-full">
          <app-pane-title>
              <a [routerLink]="'/level/' + level.levelId + '/' + (level.title | slug) + '/leaderboard'">
                  Leaderboard
              </a>
          </app-pane-title>
          <app-divider></app-divider>
          <app-level-leaderboard [level]="level"></app-level-leaderboard>
      </app-container>
      <app-container class="w-full">
          <app-pane-title>
              <a [routerLink]="'/level/' + level.levelId + '/' + (level.title | slug) + '/activity'">
                  Recent Activity
              </a>
          </app-pane-title>
          <app-divider></app-divider>
          @if(activityPage) {
              <app-event-page [page]="activityPage" [compact]="true"></app-event-page>
          }
      </app-container>
  </app-two-pane-layout>
}
